---
title: Repository Setup Guide
description: Configure your repository for optimal OpenHands performance
---

## Overview

Proper repository setup helps OpenHands work more effectively with your codebase. This guide covers configuration options that improve the agent's understanding of your project and enable smoother workflows.

## Essential Configuration

### Test Commands

Tell OpenHands how to run your tests by creating a `.openhands/config.toml` file:

```toml
[repository]
test_command = "npm test"
```

Common test command examples:

| Project Type | Test Command |
|--------------|--------------|
| Node.js/npm | `npm test` |
| Node.js/yarn | `yarn test` |
| Python/pytest | `pytest` |
| Python/unittest | `python -m unittest discover` |
| Go | `go test ./...` |
| Rust | `cargo test` |
| Java/Maven | `mvn test` |
| Java/Gradle | `./gradlew test` |

<Tip>
Include any necessary flags. For example: `npm test -- --coverage` or `pytest -v --tb=short`
</Tip>

### Lint Commands

Configure linting to maintain code quality:

```toml
[repository]
test_command = "npm test"
lint_command = "npm run lint"
```

Common lint commands:

| Project Type | Lint Command |
|--------------|--------------|
| JavaScript/ESLint | `npm run lint` or `eslint .` |
| TypeScript | `npm run lint` or `tsc --noEmit` |
| Python/Flake8 | `flake8` |
| Python/Ruff | `ruff check .` |
| Python/Black | `black --check .` |
| Go | `golint ./...` |
| Rust | `cargo clippy` |

### Build Commands

For projects that require building:

```toml
[repository]
test_command = "npm test"
lint_command = "npm run lint"
build_command = "npm run build"
```

## Environment Variables

### Setting Environment Variables

Configure environment variables needed for your project:

```toml
[repository]
test_command = "npm test"

[environment]
DATABASE_URL = "postgresql://localhost:5432/test"
API_KEY = "${API_KEY}"  # Reference from system environment
NODE_ENV = "test"
```

### Secret Management

For sensitive values, use OpenHands' secrets management:

<Tabs>
  <Tab title="CLI">
    Configure secrets in `~/.openhands/config.toml`:
    ```toml
    [secrets]
    GITHUB_TOKEN = "your-token"
    API_KEY = "your-api-key"
    ```
  </Tab>
  <Tab title="Cloud">
    Add secrets through the Settings UI in OpenHands Cloud.
  </Tab>
</Tabs>

<Warning>
Never commit actual secret values to your repository. Use environment variables or the secrets manager.
</Warning>

## Dependencies Management

### Pre-Session Setup

Configure commands to run before the agent starts working:

```toml
[repository]
setup_commands = [
    "npm install",
    "npm run db:migrate"
]
```

### Common Setup Patterns

**Node.js Project:**
```toml
[repository]
setup_commands = ["npm install"]
test_command = "npm test"
lint_command = "npm run lint"
```

**Python Project:**
```toml
[repository]
setup_commands = [
    "pip install -r requirements.txt",
    "pip install -r requirements-dev.txt"
]
test_command = "pytest"
lint_command = "ruff check . && black --check ."
```

**Monorepo:**
```toml
[repository]
setup_commands = [
    "npm install",
    "npm run bootstrap"  # For Lerna or similar
]
```

## Custom Setup Scripts

For complex setups, create a script:

```bash
#!/bin/bash
# .openhands/setup.sh

# Install dependencies
npm install

# Set up database
docker-compose up -d postgres
sleep 5
npm run db:migrate
npm run db:seed

# Generate types
npm run generate:types
```

Then reference it in your config:

```toml
[repository]
setup_commands = ["bash .openhands/setup.sh"]
```

## Per-Repository Configuration

### Full Configuration Example

```toml
# .openhands/config.toml

[repository]
# Commands
test_command = "npm test"
lint_command = "npm run lint"
build_command = "npm run build"
setup_commands = ["npm install"]

# Repository description (helps agent understand context)
description = "E-commerce API built with Node.js and PostgreSQL"

[environment]
NODE_ENV = "development"
DATABASE_URL = "postgresql://localhost:5432/myapp_dev"
REDIS_URL = "redis://localhost:6379"

[agent]
# Preferred patterns
coding_style = "functional"
testing_framework = "jest"
```

### File Locations

| File | Purpose |
|------|---------|
| `.openhands/config.toml` | Main configuration file |
| `.openhands/setup.sh` | Custom setup script |
| `.openhands/microagents/repo.md` | Repository-specific instructions ([Skills](/overview/skills/repo)) |

## Skills (Repository Instructions)

Create `.openhands/microagents/repo.md` to provide repository-specific guidance:

```markdown
# Repository Guidelines

## Architecture
- This is a Node.js REST API using Express
- Database: PostgreSQL with Prisma ORM
- Authentication: JWT tokens stored in HTTP-only cookies

## Coding Standards
- Use functional components and hooks
- Write tests for all new features
- Follow existing error handling patterns in src/utils/errors.ts

## Important Files
- `src/routes/index.ts` - API route definitions
- `src/services/` - Business logic
- `src/models/` - Prisma models

## Commands
- `npm run dev` - Start development server
- `npm test` - Run all tests
- `npm run db:migrate` - Run database migrations
```

See [Repository Skills](/overview/skills/repo) for more details.

## Troubleshooting Common Setup Issues

### Dependencies Not Installing

**Problem:** Agent can't install dependencies.

**Solutions:**
1. Verify `setup_commands` in config
2. Check for missing system dependencies
3. Ensure package manager is available

```toml
[repository]
setup_commands = [
    "npm install --legacy-peer-deps"  # If peer dependency issues
]
```

### Tests Not Running

**Problem:** Tests fail to execute.

**Solutions:**
1. Verify the test command works locally
2. Check for missing environment variables
3. Ensure test database is available

```toml
[environment]
CI = "true"  # Some test frameworks need this
```

### Build Failures

**Problem:** Build command fails.

**Solutions:**
1. Run build locally to verify it works
2. Check for missing build dependencies
3. Ensure correct Node/Python version

### Database Connection Issues

**Problem:** Can't connect to database.

**Solutions:**
1. Use Docker for local databases:
   ```toml
   [repository]
   setup_commands = [
       "docker-compose up -d db",
       "sleep 5",
       "npm run db:migrate"
   ]
   ```
2. Use SQLite for testing:
   ```toml
   [environment]
   DATABASE_URL = "file:./test.db"
   ```

## Best Practices

### 1. Keep Setup Fast

Optimize setup commands for speed:
- Use caching where possible
- Avoid unnecessary installations
- Consider using pre-built Docker images

### 2. Use Consistent Environments

Ensure the OpenHands environment matches your development environment:
- Same Node/Python versions
- Same package manager
- Same database setup

### 3. Document Requirements

In your `repo.md` file, document:
- Required services (databases, cache, etc.)
- Environment variable requirements
- Build prerequisites

### 4. Test Your Config

Before relying on OpenHands for important tasks:
1. Clone a fresh copy of your repo
2. Apply only the OpenHands config
3. Verify setup and test commands work

## Configuration Reference

### Complete `config.toml` Options

```toml
[repository]
# Required commands
test_command = "npm test"

# Optional commands
lint_command = "npm run lint"
build_command = "npm run build"
format_command = "npm run format"
setup_commands = ["npm install"]

# Metadata
description = "Project description for context"
language = "typescript"

[environment]
# Environment variables
KEY = "value"

[agent]
# Agent behavior settings
max_iterations = 50
auto_lint = true
auto_test = true
```

## See Also

- [Repository Skills](/overview/skills/repo)
- [Configuration Options](/openhands/usage/advanced/configuration-options)
- [Headless Mode](/openhands/usage/cli/headless) - For CI/CD integration
- [Custom Sandbox Guide](/openhands/usage/advanced/custom-sandbox-guide)
