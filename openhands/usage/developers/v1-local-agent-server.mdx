---
title: Run OpenHands V1 App-Server with Local SDK Agent-Server (No Docker) and Integrate a Custom Agent
description: Run the OpenHands V1 app-server backed by a purely local agent-server from software-agent-sdk, and learn multiple ways to integrate a custom SDK agent.
---

This guide shows how to:
- Run the OpenHands V1 app-server while spawning a fully local agent-server process (no Docker, no remote runtime)
- Build a custom agent with software-agent-sdk and integrate it into the locally running app-server

<Note>
Applies to the V1 app-server path enabled under <code>/api/v1</code>.
</Note>

## Prerequisites
- Python 3.12, Node 22.x, Poetry 1.8+
- OpenHands repository checked out
- <code>software-agent-sdk</code> is an install-time dependency of OpenHands (see <code>pyproject.toml</code>), and provides the <code>openhands.agent_server</code> entrypoint

## Where V1 Lives (Execution Path Overview)
OpenHands V1 exposes its API under <code>/api/v1</code> and keeps the V1 server logic in <code>app_server/</code>:
- The FastAPI app includes V1 only when <code>ENABLE_V1</code> != <code>"0"</code>. See [server/app.py](https://github.com/OpenHands/OpenHands/blob/main/openhands/server/app.py#L90-L98).
- The V1 router aggregates <code>app_server</code> endpoints. See [v1_router.py](https://github.com/OpenHands/OpenHands/blob/main/openhands/app_server/v1_router.py).
- For a local runtime, the app-server launches a separate agent-server process (from software-agent-sdk) on a free localhost port via the process sandbox: [process_sandbox_service](https://github.com/OpenHands/OpenHands/blob/main/openhands/app_server/sandbox/process_sandbox_service.py#L113-L154). It executes <code>python -m openhands.agent_server</code> and probes <code>/alive</code>.
- This selection comes from env→config wiring. When <code>RUNTIME</code> is <code>local</code> or <code>process</code>, injectors select the process-based sandbox/spec: see [app_server/config.py](https://github.com/OpenHands/OpenHands/blob/main/openhands/app_server/config.py#L102-L160) and [process_sandbox_spec_service.py](https://github.com/OpenHands/OpenHands/blob/main/openhands/app_server/sandbox/process_sandbox_spec_service.py#L17-L34).
- On the SDK side, the agent-server exposes <code>/alive</code> and <code>/health</code> (and <code>/api/*</code>). See [server_details_router.py](https://github.com/OpenHands/software-agent-sdk/blob/main/openhands-agent-server/openhands/agent_server/server_details_router.py#L27-L41) and bootstrap in [agent_server/__main__.py](https://github.com/OpenHands/software-agent-sdk/blob/main/openhands-agent-server/openhands/agent_server/__main__.py#L1-L40).
- The app-server talks to the agent-server using <code>AsyncRemoteWorkspace</code> and the agent-server REST/WebSocket API. See [AsyncRemoteWorkspace](https://github.com/OpenHands/software-agent-sdk/blob/main/openhands-sdk/openhands/sdk/workspace/remote/async_remote_workspace.py) and where the app-server builds conversation requests in <code>_build_start_conversation_request_for_user</code> ([source](https://github.com/OpenHands/OpenHands/blob/main/openhands/app_server/app_conversation/live_status_app_conversation_service.py#L929-L1014)).

## Part 1 — Run App-Server with a Purely Local Agent-Server

### 1) Build OpenHands and Enable V1
By default V1 is enabled (unless <code>ENABLE_V1=0</code>). Ensure you’re on Python 3.12 and have Poetry and Node installed, then:

```bash Build
export INSTALL_DOCKER=0         # No Docker for this guide
export RUNTIME=local            # Force process-based sandbox (spawns local agent-server)
# optional: export ENABLE_V1=1  # V1 is enabled by default; set explicitly if you disabled it elsewhere

make build
```

### 2) Run Backend and Frontend
For local development, either run everything together or separately.

```bash Full App (Backend + Frontend)
# Adjust ports/hosts if you’re on a remote machine.
make run FRONTEND_PORT=12000 FRONTEND_HOST=0.0.0.0 BACKEND_HOST=0.0.0.0
```

or start servers individually:

```bash Separate Servers
make start-backend
make start-frontend
```

### 3) Start a V1 Conversation (Spawns Local Agent-Server)
From the UI (Chat → Start) or via the V1 endpoints under <code>/api/v1</code>, create a new conversation. The app-server will:
- Start a sandbox using the process sandbox service, which launches a local agent-server process via <code>python -m openhands.agent_server</code>
- Poll the agent-server <code>/alive</code> endpoint until it reports status <code>ok</code>
- Store the agent-server URL and a per-sandbox session API key, then reuse it for subsequent operations

### 4) Verify the Local Agent-Server
You can list sandboxes via V1 API and find the exposed agent-server URL; the name in the response is <code>"agent-server"</code>. The health checks are:
- GET `{agent_server_url}/alive` → `{"status":"ok"}` (see [server_details_router.py](https://github.com/OpenHands/software-agent-sdk/blob/main/openhands-agent-server/openhands/agent_server/server_details_router.py#L27-L41))
- GET `{agent_server_url}/server_info` for uptime/idle info

### 5) How the App-Server Talks to the Agent-Server
When reading/writing files or executing commands in the conversation’s workspace, the app-server uses <code>AsyncRemoteWorkspace</code> that targets the agent-server. Example usage: [app_conversation_router.read_conversation_file](https://github.com/OpenHands/OpenHands/blob/main/openhands/app_server/app_conversation/app_conversation_router.py#L335-L409) and throughout [live_status_app_conversation_service](https://github.com/OpenHands/OpenHands/blob/main/openhands/app_server/app_conversation/live_status_app_conversation_service.py).

## Part 2 — Build a Custom Agent with the SDK and Integrate Locally
There are two practical paths, depending on how much you want to change.

### Path A — Skills and MCP Servers (No-Code)
V1 lets you customize the agent that runs inside the agent-server by layering skills and MCP servers. The app-server automatically loads:
- User skills from <code>~/.openhands/skills</code> and <code>~/.openhands/microagents/</code> via the SDK’s loader (see [load_user_skills](https://github.com/OpenHands/software-agent-sdk/blob/main/openhands-sdk/openhands/sdk/context/skills.py)), which the app-server calls in [skill loading](https://github.com/OpenHands/OpenHands/blob/main/openhands/app_server/app_conversation/app_conversation_service_base.py#L56-L104).
- Org/repo skills from your target repository via [skill_loader.py](https://github.com/OpenHands/OpenHands/blob/main/openhands/app_server/app_conversation/skill_loader.py).
- MCP servers: the app-server assembles an SDK-compatible <code>mcpServers</code> config (default OpenHands server + Tavily if available, and any custom MCP servers you set in user settings). See <code>_configure_llm_and_mcp</code> ([source](https://github.com/OpenHands/OpenHands/blob/main/openhands/app_server/app_conversation/live_status_app_conversation_service.py#L804-L865)).

<strong>Example: Add a User Skill</strong>
1. Create a file <code>~/.openhands/skills/security_expert.md</code>

```markdown Skill: security_expert.md
---
triggers:
- security
---
# Security Expert
You are a cybersecurity expert. Always consider security implications.
```

2. Start a V1 conversation and include the word “security” in your ask. The skill is merged into the agent’s context by the app-server (see [merge path](https://github.com/OpenHands/OpenHands/blob/main/openhands/app_server/app_conversation/app_conversation_service_base.py#L84-L115)).

### Path B — Custom SDK Agent via App-Server
- The agent-server API accepts a full Agent specification (LLM, tools, context, etc.) as part of <code>StartConversationRequest</code> (see [conversation_router](https://github.com/OpenHands/software-agent-sdk/blob/main/openhands-agent-server/openhands/agent_server/conversation_router.py#L67-L105)).
- In OpenHands V1, the app-server constructs this Agent for you based on <code>AgentType</code> (<code>DEFAULT</code> or <code>PLAN</code>), LLM settings, MCP config, and merged skills. See <code>_create_agent_with_context</code> ([source](https://github.com/OpenHands/OpenHands/blob/main/openhands/app_server/app_conversation/live_status_app_conversation_service.py#L866-L923)) and how it finishes the request in <code>_finalize_conversation_request</code> ([source](https://github.com/OpenHands/OpenHands/blob/main/openhands/app_server/app_conversation/live_status_app_conversation_service.py#L1016-L1082)).

You can customize behavior without forking by:
- Switching <code>AgentType</code> between <code>DEFAULT</code> and <code>PLAN</code> via the Start request (UI or API) to change tool presets (see [tool presets](https://github.com/OpenHands/software-agent-sdk/blob/main/openhands-tools/openhands/tools/preset)).
- Supplying skills and MCP servers as described above.

<strong>Advanced: Add a New Agent Type to OpenHands</strong>
If you want the UI and app-server to create your own agent layout (custom tools/system prompt/etc.), extend OpenHands:
1. Add a new enum to [AgentType](https://github.com/OpenHands/OpenHands/blob/main/openhands/app_server/app_conversation/app_conversation_models.py#L18-L26).
2. Update <code>_create_agent_with_context</code> ([source](https://github.com/OpenHands/OpenHands/blob/main/openhands/app_server/app_conversation/live_status_app_conversation_service.py#L866-L923)) to construct your Agent when your new type is selected.
3. Optionally expose the type in the frontend to make it selectable.

### Path C — Test with the SDK Directly (Optional but Useful)
The SDK ships standalone examples you can run locally to validate your Agent design before wiring through OpenHands. See:
- **[Local Agent Server](/sdk/guides/agent-server/local-server)**
- **[Agent Server Overview](/sdk/guides/agent-server/overview)**

## Troubleshooting
- If no agent-server starts when you create a V1 conversation, ensure:
  - <code>ENABLE_V1</code> is not <code>"0"</code> (V1 router included): [server/app.py](https://github.com/OpenHands/OpenHands/blob/main/openhands/server/app.py#L90-L98)
  - <code>RUNTIME</code> = <code>local</code> or <code>process</code> so the process sandbox is selected: [config_from_env](https://github.com/OpenHands/OpenHands/blob/main/openhands/app_server/config.py#L102-L160)
  - The spawned server is probed via <code>/alive</code>: [process_sandbox_service](https://github.com/OpenHands/OpenHands/blob/main/openhands/app_server/sandbox/process_sandbox_service.py#L155-L200)
- To inspect the agent-server API, open its Swagger at `{agent_server_url}/docs` (the server is started via uvicorn in [__main__.py](https://github.com/OpenHands/software-agent-sdk/blob/main/openhands-agent-server/openhands/agent_server/__main__.py#L1-L40)).

## References
- OpenHands V1 app-server boot and routing: [server/app.py](https://github.com/OpenHands/OpenHands/blob/main/openhands/server/app.py#L90-L98), [v1_router.py](https://github.com/OpenHands/OpenHands/blob/main/openhands/app_server/v1_router.py)
- Sandbox process service (spawns local agent-server): [process_sandbox_service.py](https://github.com/OpenHands/OpenHands/blob/main/openhands/app_server/sandbox/process_sandbox_service.py#L113-L200)
- Env→injector selection for local runtime: [config.py](https://github.com/OpenHands/OpenHands/blob/main/openhands/app_server/config.py#L102-L160)
- Default command and env to start agent-server: [process_sandbox_spec_service.py](https://github.com/OpenHands/OpenHands/blob/main/openhands/app_server/sandbox/process_sandbox_spec_service.py#L17-L34)
- Agent-server app and health endpoints: [__main__.py](https://github.com/OpenHands/software-agent-sdk/blob/main/openhands-agent-server/openhands/agent_server/__main__.py#L1-L40), [server_details_router.py](https://github.com/OpenHands/software-agent-sdk/blob/main/openhands-agent-server/openhands/agent_server/server_details_router.py#L27-L41)
- Agent-server conversation API: [conversation_router.py](https://github.com/OpenHands/software-agent-sdk/blob/main/openhands-agent-server/openhands/agent_server/conversation_router.py)
- AsyncRemoteWorkspace client: [async_remote_workspace.py](https://github.com/OpenHands/software-agent-sdk/blob/main/openhands-sdk/openhands/sdk/workspace/remote/async_remote_workspace.py)
- V1 agent composition in app-server: [live_status_app_conversation_service.py](https://github.com/OpenHands/OpenHands/blob/main/openhands/app_server/app_conversation/live_status_app_conversation_service.py)
- Skills loading and merge points: [app_conversation_service_base.py](https://github.com/OpenHands/OpenHands/blob/main/openhands/app_server/app_conversation/app_conversation_service_base.py#L56-L115), [skill_loader.py](https://github.com/OpenHands/OpenHands/blob/main/openhands/app_server/app_conversation/skill_loader.py)
- SDK documentation on agent-server modes: [/sdk/guides/agent-server/overview](/sdk/guides/agent-server/overview), [/sdk/guides/agent-server/local-server](/sdk/guides/agent-server/local-server)
