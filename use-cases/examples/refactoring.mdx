---
title: "Code Refactoring"
sidebarTitle: "Refactoring"
description: "Using OpenHands for safe code refactoring"
---

# Code Refactoring

OpenHands can help refactor code to improve quality while preserving functionality.

## Refactoring Types

### Structural Refactoring

- Extract methods/functions
- Extract classes
- Move code to appropriate modules
- Reduce duplication

### Pattern Refactoring

- Apply design patterns
- Remove anti-patterns
- Improve code organization

### Performance Refactoring

- Optimize algorithms
- Reduce complexity
- Improve efficiency

## Prerequisites

<Callout type="warning" title="Test Coverage First">
Before refactoring, ensure adequate test coverage exists to verify behavior is preserved.
</Callout>

## Instruction Template

```markdown
## Current State
[Describe the current code structure/issue]

## Desired State  
[Describe the target structure]

## Scope
Files to modify: [list]
Files NOT to modify: [list]

## Constraints
- Maintain backward compatibility
- No changes to public APIs
- All tests must pass

## Verification
[How to verify the refactoring succeeded]
```

## Example: Extract Service

### Request

```markdown
Extract email sending logic into a dedicated service.

Current state:
- Email sending scattered across UserController, OrderController, AuthController
- Duplicate SMTP configuration in each location
- No consistent error handling

Desired state:
- Single EmailService class
- Consistent error handling and logging
- Easy to mock for testing

Files to modify:
- Create: src/services/email_service.py
- Update: src/controllers/user.py
- Update: src/controllers/order.py
- Update: src/controllers/auth.py

Constraints:
- Don't change email content
- Don't change when emails are sent
- Maintain existing function signatures

Verification:
- All existing tests pass
- New unit tests for EmailService
- Manual test: trigger each email type
```

## Best Practices

<AccordionGroup>
  <Accordion title="Small Steps">
    Make incremental changes, verifying after each step.
  </Accordion>
  <Accordion title="Test First">
    Ensure tests exist before refactoring.
  </Accordion>
  <Accordion title="Behavior Preservation">
    Refactoring changes structure, not behavior.
  </Accordion>
  <Accordion title="Clear Boundaries">
    Define exactly what should and shouldn't change.
  </Accordion>
</AccordionGroup>

## Common Refactoring Tasks

| Task | Good For |
|------|----------|
| Extract Method | Long functions with distinct sections |
| Extract Class | Classes with multiple responsibilities |
| Move Method | Method in wrong class |
| Rename | Unclear naming |
| Replace Conditional with Polymorphism | Complex if/else chains |
| Introduce Parameter Object | Functions with many parameters |

<Card title="Best Practices Guide" icon="lightbulb" href="/use-cases/best-practices">
  More tips for successful refactoring
</Card>
