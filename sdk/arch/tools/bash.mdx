---
title: BashTool
description: Execute bash commands with persistent session support, timeout control, and environment management.
---

BashTool enables agents to execute bash commands in a persistent session with full control over working directory, environment variables, and execution timeout.

**Source**: [`openhands/tools/execute_bash/`](https://github.com/All-Hands-AI/agent-sdk/tree/main/openhands/tools/execute_bash)

## Overview

BashTool provides:
- Persistent bash session across multiple commands
- Environment variable management
- Timeout control for long-running commands
- Working directory configuration
- Support for both local and remote execution

## Usage

### Basic Usage

```python
from openhands.tools import BashTool

# Create tool
bash_tool = BashTool.create()

# Use with agent
from openhands.sdk import Agent

agent = Agent(
    llm=llm,
    tools=[bash_tool]
)
```

### With Configuration

```python
bash_tool = BashTool.create(
    working_dir="/project/path",
    timeout=60.0  # 60 seconds
)
```

## Action Model

**Source**: [`openhands/tools/execute_bash/definition.py`](https://github.com/All-Hands-AI/agent-sdk/blob/main/openhands/tools/execute_bash/definition.py)

```python
class BashAction(Action):
    command: str  # Bash command to execute
    thought: str = ""  # Optional reasoning
```

### Example

```python
from openhands.tools import BashAction

action = BashAction(
    command="ls -la",
    thought="List files to understand directory structure"
)
```

## Observation Model

```python
class BashObservation(Observation):
    output: str  # Command output (stdout + stderr)
    exit_code: int  # Exit code (0 = success)
```

### Example

```python
# Successful execution
observation = BashObservation(
    output="file1.txt\nfile2.py\n",
    exit_code=0
)

# Failed execution
observation = BashObservation(
    output="command not found: invalid_cmd\n",
    exit_code=127
)
```

## Features

### Persistent Session

Commands execute in the same bash session, preserving:
- Environment variables
- Working directory changes
- Shell state

```python
# Set environment variable
agent.run("export API_KEY=secret")

# Use in next command
agent.run("echo $API_KEY")  # Outputs: secret
```

### Terminal Types

**Source**: [`openhands/tools/execute_bash/terminal/`](https://github.com/All-Hands-AI/agent-sdk/tree/main/openhands/tools/execute_bash/terminal)

BashTool supports multiple terminal implementations:

- **SubprocessTerminal**: Direct subprocess execution (default)
- **TmuxTerminal**: Tmux-based persistent sessions

### Timeout Control

Commands automatically timeout after the specified duration:

```python
bash_tool = BashTool.create(timeout=30.0)  # 30 second timeout

# Long-running command will be terminated
action = BashAction(command="sleep 60")  # Timeout after 30s
```

### Environment Management

Set custom environment variables:

```python
# Via workspace secrets
from openhands.sdk import Conversation

conversation = Conversation(
    agent=agent,
    secrets={
        "DATABASE_URL": "postgres://...",
        "API_KEY": "secret"
    }
)
```

See [`examples/01_standalone_sdk/12_custom_secrets.py`](https://github.com/All-Hands-AI/agent-sdk/blob/main/examples/01_standalone_sdk/12_custom_secrets.py).

## Common Use Cases

### File Operations

```python
# Create directory
BashAction(command="mkdir -p /path/to/dir")

# Copy files
BashAction(command="cp source.txt dest.txt")

# Find files
BashAction(command="find . -name '*.py'")
```

### Build and Test

```python
# Install dependencies
BashAction(command="pip install -r requirements.txt")

# Run tests
BashAction(command="pytest tests/")

# Build project
BashAction(command="npm run build")
```

### Git Operations

```python
# Clone repository
BashAction(command="git clone https://github.com/user/repo.git")

# Create branch
BashAction(command="git checkout -b feature-branch")

# Commit changes
BashAction(command='git commit -m "Add feature"')
```

### System Information

```python
# Check disk space
BashAction(command="df -h")

# List processes
BashAction(command="ps aux")

# Network information
BashAction(command="ifconfig")
```

## Best Practices

1. **Set Appropriate Timeouts**: Prevent hanging on long commands
2. **Use Absolute Paths**: Or configure working directory explicitly
3. **Check Exit Codes**: Verify command success in agent logic
4. **Escape Special Characters**: Properly quote arguments
5. **Avoid Interactive Commands**: BashTool works best with non-interactive commands
6. **Use Security Analysis**: Enable for sensitive operations

## Security Considerations

### Risk Assessment

BashTool actions have varying risk levels:

- **LOW**: Read operations (`ls`, `cat`, `grep`)
- **MEDIUM**: Write operations (`touch`, `mkdir`, `echo >`)
- **HIGH**: Destructive operations (`rm -rf`, `sudo`, `chmod`)

### Enable Security

```python
from openhands.sdk.security import LLMSecurityAnalyzer, ConfirmOnHighRisk

agent = Agent(
    llm=llm,
    tools=[BashTool.create()],
    security_analyzer=LLMSecurityAnalyzer(llm=llm),
    confirmation_policy=ConfirmOnHighRisk()
)
```

### Sandboxing

Use DockerWorkspace for isolation:

```python
from openhands.workspace import DockerWorkspace

workspace = DockerWorkspace(
    working_dir="/workspace",
    image="ubuntu:22.04"
)

conversation = Conversation(agent=agent, workspace=workspace)
```

## Error Handling

### Common Exit Codes

- `0`: Success
- `1`: General error
- `2`: Misuse of shell builtin
- `126`: Command not executable
- `127`: Command not found
- `130`: Terminated by Ctrl+C
- `137`: Killed by SIGKILL (timeout)

### Handling Failures

```python
# Agent can check observation
if observation.exit_code != 0:
    # Handle error based on output
    if "permission denied" in observation.output.lower():
        # Retry with different approach
        pass
```

## Implementation Details

**Source**: [`openhands/tools/execute_bash/impl.py`](https://github.com/All-Hands-AI/agent-sdk/blob/main/openhands/tools/execute_bash/impl.py)

The tool uses a terminal interface that:
1. Initializes a persistent bash session
2. Executes commands with timeout support
3. Captures stdout and stderr
4. Returns exit codes
5. Handles session cleanup

## See Also

- **[FileEditorTool](/sdk/architecture/tools/file_editor.mdx)** - For file manipulation
- **[Tool Definition](/sdk/architecture/sdk/tool.mdx)** - Creating custom tools
- **[Security](/sdk/architecture/sdk/security.mdx)** - Tool security
- **[Examples](https://github.com/All-Hands-AI/agent-sdk/tree/main/examples)** - Usage examples
