---
title: TODO Management
description: Automate TODO implementation with AI-powered code changes using GitHub Actions.
---

<Note>
This example is available on GitHub: [examples/03_github_workflows/03_todo_management/](https://github.com/All-Hands-AI/agent-sdk/tree/main/examples/03_github_workflows/03_todo_management)
</Note>

Automatically scan your codebase for TODO comments and let the AI agent implement them, creating pull requests with the changes. This showcases practical automation and self-improving codebase capabilities.

## Quick Start

```bash
# 1. Copy workflow to your repository
cp examples/03_github_workflows/03_todo_management/workflow.yml .github/workflows/todo-management.yml

# 2. Configure secrets in GitHub Settings → Secrets
# Add: LLM_API_KEY

# 3. Configure GitHub Actions permissions
# Settings → Actions → General → Workflow permissions
# Enable: "Read and write permissions" + "Allow GitHub Actions to create and approve pull requests"

# 4. Add TODO comments to your code
# Example: # TODO(openhands): Add input validation for user email
```

## Features

- **Smart Scanning** - Finds legitimate TODO comments with configurable identifiers
- **AI Implementation** - Uses OpenHands agent to automatically implement TODOs
- **PR Management** - Creates feature branches and pull requests automatically
- **Progress Tracking** - Tracks TODO processing status and PR creation
- **Comprehensive Reporting** - Detailed GitHub Actions summary with processing status
- **Configurable** - Customizable TODO identifiers and processing limits

## How It Works

### 1. Scan Phase

The workflow scans your codebase for configurable TODO comments:

```python icon="python" expandable examples/03_github_workflows/03_todo_management/scanner.py
#!/usr/bin/env python3
"""
TODO Scanner for OpenHands Automated TODO Management

Scans for configurable TODO comments in Python, TypeScript, Java, and Rust files.
Default identifier: TODO(openhands)
"""

import argparse
import json
import logging
import os
import re
import sys
from pathlib import Path


# Configure logging
logging.basicConfig(
    level=logging.INFO,
    format="%(asctime)s - %(name)s - %(levelname)s - %(message)s",
    handlers=[
        # Log to stderr to avoid JSON interference
        logging.StreamHandler(sys.stderr),
    ],
)
logger = logging.getLogger(__name__)


def scan_file_for_todos(
    file_path: Path, todo_identifier: str = "TODO(openhands)"
) -> list[dict]:
    """Scan a single file for configurable TODO comments."""
    # Only scan specific file extensions
    if file_path.suffix.lower() not in {".py", ".ts", ".java", ".rs"}:
        logger.debug(f"Skipping file {file_path} (unsupported extension)")
        return []

    # Skip test files and example files that contain mock TODOs
    file_str = str(file_path)
    if (
        "/test" in file_str
        or "/tests/" in file_str
        or "test_" in file_path.name
        # Skip examples
        or "examples/03_github_workflows/03_todo_management/" in file_str
    ):
        logger.debug(f"Skipping test/example file: {file_path}")
        return []

    logger.debug(f"Scanning file: {file_path}")

    try:
        with open(file_path, encoding="utf-8", errors="ignore") as f:
            lines = f.readlines()
    except (OSError, UnicodeDecodeError) as e:
        logger.warning(f"Failed to read file {file_path}: {e}")
        return []

    todos = []
    # Escape special regex characters in the identifier
    escaped_identifier = re.escape(todo_identifier)
    todo_pattern = re.compile(rf"{escaped_identifier}(?::\s*(.*))?", re.IGNORECASE)

    for line_num, line in enumerate(lines, 1):
        match = todo_pattern.search(line)
        if match:
            # Extract initial description from the TODO line
            description = match.group(1).strip() if match.group(1) else ""

            # Look ahead for continuation lines that are also comments
            continuation_lines = []
            for next_line_idx in range(line_num, len(lines)):
                next_line = lines[next_line_idx]
                next_stripped = next_line.strip()

                # Check if this line is a comment continuation
                if (
                    next_stripped.startswith("#")
                    and not next_stripped.startswith(f"# {todo_identifier}")
                    # Skip empty comment lines
                    and next_stripped != "#"
                    # Must have content after #
                    and len(next_stripped) > 1
                ):
                    # Extract comment content (remove # and leading whitespace)
                    comment_content = next_stripped[1:].strip()

                    if comment_content:  # Only add non-empty content
                        continuation_lines.append(comment_content)
                elif next_stripped == "#":
                    # Empty comment line - continue looking
                    continue
                else:
                    # Stop at first non-comment line
                    break

            # Combine description with continuation lines
            if continuation_lines:
                if description:
                    full_description = description + " " + " ".join(continuation_lines)
                else:
                    full_description = " ".join(continuation_lines)
            else:
                full_description = description

            todo_item = {
                "file": str(file_path),
                "line": line_num,
                "description": full_description,
            }
            todos.append(todo_item)
            logger.info(f"Found TODO in {file_path}:{line_num}: {full_description}")

    if todos:
        logger.info(f"Found {len(todos)} TODO(s) in {file_path}")
    return todos


def scan_directory(
    directory: Path, todo_identifier: str = "TODO(openhands)"
) -> list[dict]:
    """Recursively scan a directory for configurable TODO comments."""
    logger.info(f"Scanning directory: {directory}")
    all_todos = []

    for root, dirs, files in os.walk(directory):
        # Skip hidden and common ignore directories
        dirs[:] = [
            d
            for d in dirs
            if not d.startswith(".")
            and d
            not in {
                "__pycache__",
                "node_modules",
                ".venv",
                "venv",
                "build",
                "dist",
            }
        ]

        for file in files:
            file_path = Path(root) / file
            todos = scan_file_for_todos(file_path, todo_identifier)
            all_todos.extend(todos)

    return all_todos


def main():
    """Main function to scan for TODOs and output results."""
    parser = argparse.ArgumentParser(
        description="Scan codebase for configurable TODO comments"
    )
    parser.add_argument(
        "directory",
        nargs="?",
        default=".",
        help="Directory to scan (default: current directory)",
    )
    parser.add_argument("--output", "-o", help="Output file (default: stdout)")
    parser.add_argument(
        "--identifier",
        "-i",
        default="TODO(openhands)",
        help="TODO identifier to search for (default: TODO(openhands))",
    )

    args = parser.parse_args()

    path = Path(args.directory)
    if not path.exists():
        logger.error(f"Path '{path}' does not exist")
        return 1

    if path.is_file():
        logger.info(f"Starting TODO scan on file: {path}")
        todos = scan_file_for_todos(path, args.identifier)
    else:
        logger.info(f"Starting TODO scan in directory: {path}")
        todos = scan_directory(path, args.identifier)
    logger.info(f"Scan complete. Found {len(todos)} total TODO(s)")
    output = json.dumps(todos, indent=2)

    if args.output:
        with open(args.output, "w", encoding="utf-8") as f:
            f.write(output)
        print(f"Found {len(todos)} TODO(s), written to {args.output}")
    else:
        print(output)

    return 0


if __name__ == "__main__":
    exit(main())
```

The scanner:
- Default identifier: `TODO(openhands)` (customizable via workflow input)
- Filters out false positives (documentation, test files, quoted strings)
- Supports Python, TypeScript, Java, and Rust files (`.py`, `.ts`, `.java`, `.rs`)
- Provides detailed logging of found TODOs

Key functions:

```python
def scan_file_for_todos(file_path: Path, todo_identifier: str = "TODO(openhands)") -> list[dict]:
    """Scan a single file for configurable TODO comments."""
```

### 2. Process Phase

For each TODO found, the agent script implements it:

```python icon="python" expandable examples/03_github_workflows/03_todo_management/agent_script.py
#!/usr/bin/env python3
"""
TODO Agent for OpenHands Automated TODO Management

This script processes individual TODO(openhands) comments using OpenHands agent
to implement the TODO. Designed for use with GitHub Actions workflows.

Usage:
    python agent_script.py <todo_json>

Arguments:
    todo_json: JSON string containing TODO information from scanner.py

Environment Variables:
    LLM_API_KEY: API key for the LLM (required)
    LLM_MODEL: Language model to use (default: openhands/claude-sonnet-4-5-20250929)
    LLM_BASE_URL: Optional base URL for LLM API
    GITHUB_TOKEN: GitHub token for creating PRs (required)
    GITHUB_REPOSITORY: Repository in format owner/repo (required)

For setup instructions and usage examples, see README.md in this directory.
"""

import argparse
import json
import os
import sys

from prompt import PROMPT

from openhands.sdk import LLM, Conversation, get_logger
from openhands.tools.preset.default import get_default_agent


logger = get_logger(__name__)


def process_todo(todo_data: dict):
    """Process a single TODO item using OpenHands agent."""
    file_path = todo_data["file"]
    line_num = todo_data["line"]
    description = todo_data["description"]

    logger.info(f"Processing TODO in {file_path}:{line_num}")

    # Configure LLM
    api_key = os.getenv("LLM_API_KEY")
    if not api_key:
        logger.error("LLM_API_KEY environment variable is not set.")
        sys.exit(1)

    model = os.getenv("LLM_MODEL", "openhands/claude-sonnet-4-5-20250929")
    base_url = os.getenv("LLM_BASE_URL")

    llm_config = {
        "model": model,
        "api_key": api_key,
        "service_id": "agent_script",
        "drop_params": True,
    }

    if base_url:
        llm_config["base_url"] = base_url

    llm = LLM(**llm_config)

    # Create the prompt
    prompt = PROMPT.format(
        file_path=file_path,
        line_num=line_num,
        description=description,
    )

    # Get the current working directory as workspace
    cwd = os.getcwd()

    # Create agent with default tools
    agent = get_default_agent(
        llm=llm,
        cli_mode=True,
    )

    # Create conversation
    conversation = Conversation(
        agent=agent,
        workspace=cwd,
    )

    logger.info("Starting task execution...")
    logger.info(f"Prompt: {prompt[:200]}...")

    # Send the prompt and run the agent
    conversation.send_message(prompt)
    conversation.run()

    logger.info("Task completed successfully")


def main():
    """Main function to process a TODO item."""
    parser = argparse.ArgumentParser(
        description="Process a TODO(openhands) comment using OpenHands agent"
    )
    parser.add_argument("todo_json", help="JSON string containing TODO information")

    args = parser.parse_args()

    try:
        todo_data = json.loads(args.todo_json)
    except json.JSONDecodeError as e:
        logger.error(f"Invalid JSON input: {e}")
        sys.exit(1)

    # Validate required fields
    required_fields = ["file", "line", "description"]
    for field in required_fields:
        if field not in todo_data:
            logger.error(f"Missing required field in TODO data: {field}")
            sys.exit(1)

    # Process the TODO
    process_todo(todo_data)


if __name__ == "__main__":
    main()
```

The agent:
1. Configures the LLM using environment variables
2. Creates a prompt with the TODO details
3. Uses the default agent with standard tools
4. Runs the conversation to implement the TODO

Key configuration:

```python
# Configure LLM
llm = LLM(
    model=model,
    api_key=api_key,
    service_id="agent_script",
    drop_params=True,
)

# Create agent with default tools
agent = get_default_agent(llm=llm, cli_mode=True)

# Create conversation
conversation = Conversation(agent=agent, workspace=cwd)
conversation.send_message(prompt)
conversation.run()
```

### 3. Prompt Template

The prompt guides the agent to implement the TODO and create a PR:

```python icon="python" expandable examples/03_github_workflows/03_todo_management/prompt.py
"""Prompt template for TODO implementation."""

PROMPT = """Please implement a TODO comment in a codebase.

IMPORTANT - Creating a Pull Request:
- Use the `gh pr create` command to create the PR
- The GITHUB_TOKEN environment variable is available for authentication
- PR Title: "[Openhands] {description}"
- Branch name "openhands/todo/***"

Your task is to:
1. Analyze the TODO comment and understand what needs to be implemented
2. Search in github for any existing PRs that adress this TODO
    Filter by title [Openhands]... Don't implement anything if such a PR exists
2. Create a feature branch for this implementation
3. Implement what is asked by the TODO
4. Create a pull request with your changes
5. Add 2 reviewers
    * Tag the person who wrote the TODO as a reviewer
    * read the git blame information for the files, and find the most recent and
    active contributors to the file/location of the changes.
    Assign one of these people as a reviewer.


Please make sure to:
- Create a descriptive branch name related to the TODO
- Fix the issue with clean code
- Include a test if needed, but not always necessary

TODO Details:
- File: {file_path}
- Line: {line_num}
- Description: {description}
"""
```

The prompt instructs the agent to:
- Analyze the TODO comment
- Check for existing PRs addressing this TODO
- Create a feature branch (`openhands/todo/***`)
- Implement the requested changes
- Create a pull request with title `[Openhands] {description}`
- Add reviewers (TODO author and active contributors)

## Usage

### Manual Trigger

1. Go to **Actions** → "Automated TODO Management"
2. Click **Run workflow**
3. (Optional) Configure parameters:
   - **Max TODOs**: Maximum number of TODOs to process (default: 3)
   - **TODO Identifier**: Custom identifier to search for (default: `TODO(openhands)`)
4. Click **Run workflow**

### Adding TODO Comments

Add TODO comments in the following format anywhere in your codebase:

```python
# TODO(openhands): Add input validation for user email
def process_user_email(email):
    return email.lower()

# TODO(openhands): Implement caching mechanism for API responses
def fetch_api_data(endpoint):
    # Current implementation without caching
    return requests.get(endpoint).json()
```

**Supported Comment Styles:**
- `# TODO(openhands): description` (Python, Shell, etc.)
- `// TODO(openhands): description` (TypeScript, Java, Rust, etc.)

**Custom Identifiers:**
You can use custom TODO identifiers like `TODO(myteam)`, `TODO[urgent]`, etc. Configure this in the workflow parameters.

### Scanner CLI Usage

You can also run the scanner directly from the command line:

```bash
# Scan current directory with default identifier
python scanner.py .

# Scan with custom identifier
python scanner.py . --identifier "TODO(myteam)"

# Scan specific directory and save to file
python scanner.py /path/to/code --output todos.json

# Get help
python scanner.py --help
```

## Configuration

Edit `.github/workflows/todo-management.yml` to customize:

```yaml
env:
  LLM_MODEL: openhands/claude-sonnet-4-5-20250929
  # LLM_BASE_URL: 'https://custom-api.example.com'  # Optional
  MAX_TODOS: 3  # Maximum number of TODOs to process
  TODO_IDENTIFIER: "TODO(openhands)"  # Customize the identifier
```

## Output Summary

The workflow generates a comprehensive summary showing:
- All processed TODOs with their file locations
- Associated pull request URLs for successful implementations
- Processing status (success, partial, failed) for each TODO

Example output:
```
✅ Processed 3 TODOs
  
📝 TODO #1: Add input validation for user email
   File: src/utils.py:45
   PR: https://github.com/user/repo/pull/123
   Status: ✅ Success
   
📝 TODO #2: Implement caching mechanism
   File: src/api.py:78
   PR: https://github.com/user/repo/pull/124
   Status: ✅ Success
```

## Best Practices

- **Start Small** - Begin with `MAX_TODOS: 1` to test the workflow
- **Clear Descriptions** - Write descriptive TODO comments for better AI understanding
- **Review PRs** - Always review the generated PRs before merging
- **Custom Identifiers** - Use team-specific identifiers like `TODO(backend)` for different teams
- **Scheduled Runs** - Set up cron schedules for regular TODO processing

## Related Documentation

- [Agent Script](https://github.com/All-Hands-AI/agent-sdk/blob/main/examples/03_github_workflows/03_todo_management/agent_script.py)
- [Scanner Script](https://github.com/All-Hands-AI/agent-sdk/blob/main/examples/03_github_workflows/03_todo_management/scanner.py)
- [Workflow File](https://github.com/All-Hands-AI/agent-sdk/blob/main/examples/03_github_workflows/03_todo_management/workflow.yml)
- [Prompt Template](https://github.com/All-Hands-AI/agent-sdk/blob/main/examples/03_github_workflows/03_todo_management/prompt.py)
