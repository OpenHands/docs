---
title: Custom Visualizer
description: Customize conversation visualization with custom highlighting patterns and display options.
---

<Note>
This example is available on GitHub: [examples/01_standalone_sdk/26_custom_visualizer.py](https://github.com/OpenHands/software-agent-sdk/blob/main/examples/01_standalone_sdk/26_custom_visualizer.py)
</Note>

Customize how your agent's conversation is displayed by passing a custom `ConversationVisualizer` instance directly to the `visualize` parameter.

The example below shows a comprehensive custom visualizer that subclasses `ConversationVisualizer` to create a minimal progress tracker. For simpler use cases, you can also configure the built-in `ConversationVisualizer` with custom highlighting patterns (see [Creating a Custom Visualizer](#creating-a-custom-visualizer) below).

```python icon="python" expandable examples/01_standalone_sdk/26_custom_visualizer.py
"""Custom Visualizer Example

This example demonstrates how to create and use a custom visualizer by subclassing
ConversationVisualizer. This approach provides:
- Clean, testable code with class-based state management
- Direct configuration (just pass the visualizer instance to visualize parameter)
- Reusable visualizer that can be shared across conversations
- Better separation of concerns compared to callback functions

The MinimalProgressVisualizer produces concise output showing:
- LLM call completions
- Tool execution steps with command/path details
- Agent thinking indicators
- Error messages

This demonstrates the new API improvement where you can pass a ConversationVisualizer
instance directly to the visualize parameter instead of using callbacks.
"""

import logging
import os

from pydantic import SecretStr

from openhands.sdk import LLM, Conversation
from openhands.sdk.conversation.visualizer import ConversationVisualizer
from openhands.sdk.event import (
    ActionEvent,
    AgentErrorEvent,
    MessageEvent,
    ObservationEvent,
)
from openhands.tools.preset.default import get_default_agent


class MinimalProgressVisualizer(ConversationVisualizer):
    """A minimal progress visualizer that shows step counts and tool names.

    This visualizer produces concise output showing:
    - LLM call completions
    - Tool execution steps with command/path details
    - Agent thinking indicators
    - Error messages

    Example output:
        ü§ñ LLM call completed
        Step 1: Executing str_replace_editor (view: .../FACTS.txt)... ‚úì
        üí≠ Agent thinking...
        ü§ñ LLM call completed
        Step 2: Executing str_replace_editor (str_replace: .../FACTS.txt)... ‚úì
        ‚ùå Error: File not found
    """

    def __init__(self, **kwargs):
        """Initialize the minimal progress visualizer.

        Args:
            **kwargs: Additional arguments passed to ConversationVisualizer.
                     Note: We override visualization, so most ConversationVisualizer
                     parameters are ignored, but we keep the signature for
                     compatibility.
        """
        # Initialize parent but we'll override on_event
        # We don't need the console/panels from the parent
        super().__init__(**kwargs)

        # Track state for our custom visualization
        self.step_count = 0
        self.current_action = None
        self.logger = logging.getLogger(__name__)

    def on_event(self, event):
        """Handle conversation events with minimal progress display."""
        try:
            if isinstance(event, MessageEvent):
                if event.source == "agent":
                    print("ü§ñ LLM call completed")
                elif event.source == "user":
                    print(f"üë§ User: {event.content}")

            elif isinstance(event, ActionEvent):
                self.step_count += 1
                action_name = event.action.__class__.__name__

                # Extract useful details from common actions
                details = ""
                if hasattr(event.action, "command"):
                    details = f"command: {event.action.command[:50]}..."
                elif hasattr(event.action, "path"):
                    path = event.action.path
                    if hasattr(event.action, "command"):
                        details = f"{event.action.command}: {path}"
                    else:
                        details = f"path: {path}"

                if details:
                    print(f"Step {self.step_count}: Executing {action_name} ({details})...", end=" ", flush=True)
                else:
                    print(f"Step {self.step_count}: Executing {action_name}...", end=" ", flush=True)

                self.current_action = action_name

            elif isinstance(event, ObservationEvent):
                if self.current_action:
                    # Simple success/error indication
                    if hasattr(event.observation, "error") and event.observation.error:
                        print("‚ùå")
                        print(f"‚ùå Error: {event.observation.error}")
                    else:
                        print("‚úì")
                    self.current_action = None
                else:
                    print("üí≠ Agent thinking...")

            elif isinstance(event, AgentErrorEvent):
                print(f"‚ùå Agent Error: {event.message}")

        except Exception as e:
            # Fallback to prevent visualization errors from breaking the conversation
            self.logger.warning(f"Visualization error: {e}")


def main():
    """Demonstrate the custom visualizer with a simple task."""
    # Get API key from environment
    api_key = os.environ.get("LLM_API_KEY")
    if not api_key:
        raise ValueError("LLM_API_KEY environment variable is not set")

    # Create LLM and Agent with default tools
    llm = LLM(model="gpt-4o-mini", api_key=SecretStr(api_key))
    agent = get_default_agent(llm=llm)

    # Create our custom visualizer
    custom_visualizer = MinimalProgressVisualizer()

    print("üöÄ Starting conversation with custom visualizer...")
    print("=" * 60)

    # NEW API: Pass the visualizer instance directly!
    # This is much cleaner than: visualize=False, callbacks=[custom_visualizer.on_event]
    conversation = Conversation(
        agent=agent,
        workspace="./workspace",
        visualize=custom_visualizer,  # Direct and intuitive!
    )

    # Send a message and run
    conversation.send_message(
        "Create a file called FACTS.txt with 3 interesting facts about Python programming."
    )
    conversation.run()

    print("=" * 60)
    print("‚úÖ Example completed!")
    print(f"üìä Total steps executed: {custom_visualizer.step_count}")
    print("\nThe conversation used our custom MinimalProgressVisualizer!")
    print("Compare this to the default visualizer to see the difference.")


if __name__ == "__main__":
    main()
```

```bash Running the Example
export LLM_API_KEY="your-api-key"
cd agent-sdk
uv run python examples/01_standalone_sdk/26_custom_visualizer.py
```

## Creating a Custom Visualizer

There are two approaches to creating custom visualizers:

### 1. Simple Configuration (Built-in Visualizer)

For basic customization, configure the built-in `ConversationVisualizer` with custom highlighting patterns:

```python
from openhands.sdk.conversation.visualizer import ConversationVisualizer

# Simple approach: configure the built-in visualizer
custom_visualizer = ConversationVisualizer(
    highlight_regex={
        r"^Reasoning:": "bold cyan",
        r"^Thought:": "bold green", 
        r"^Action:": "bold yellow",
    },
    skip_user_messages=False,  # Show user messages
)
```

### 2. Custom Subclass (Full Control)

For complete control over visualization logic, subclass `ConversationVisualizer`:

```python
from openhands.sdk.conversation.visualizer import ConversationVisualizer
from openhands.sdk.event import ActionEvent, MessageEvent

class MinimalProgressVisualizer(ConversationVisualizer):
    def __init__(self, **kwargs):
        super().__init__(**kwargs)
        self.step_count = 0
    
    def on_event(self, event):
        if isinstance(event, MessageEvent) and event.source == "agent":
            print("ü§ñ LLM call completed")
        elif isinstance(event, ActionEvent):
            self.step_count += 1
            action_name = event.action.__class__.__name__
            print(f"Step {self.step_count}: Executing {action_name}...")

# Use your custom visualizer
custom_visualizer = MinimalProgressVisualizer()
```

### Visualization Options

The `visualize` parameter accepts three types:

- **`True`** (default): Use the default visualizer with standard formatting
- **`False` or `None`**: Disable visualization entirely
- **`ConversationVisualizer` instance**: Use your custom visualizer

### Before and After

**Previous approach** (confusing):
```python
# Had to set visualize=False and pass callback manually
conversation = Conversation(
    agent=agent,
    workspace=cwd,
    visualize=False,  # Confusing: we DO want visualization!
    callbacks=[custom_visualizer.on_event],
)
```

**New approach** (clear and direct):
```python
# Pass the visualizer directly
conversation = Conversation(
    agent=agent,
    workspace=cwd,
    visualize=custom_visualizer,  # Direct and clear!
)
```

## Customization Options

### Highlight Patterns

Use regex patterns to highlight specific content:

```python
highlight_regex={
    r"^Reasoning:": "bold cyan",      # Lines starting with "Reasoning:"
    r"^Thought:": "bold green",       # Lines starting with "Thought:"
    r"^Action:": "bold yellow",       # Lines starting with "Action:"
    r"\[ERROR\]": "bold red",         # Error markers
    r"\[SUCCESS\]": "bold green",     # Success markers
}
```

### Available Colors and Styles

Colors: `black`, `red`, `green`, `yellow`, `blue`, `magenta`, `cyan`, `white`

Styles: `bold`, `dim`, `italic`, `underline`

Combine them: `"bold cyan"`, `"underline red"`, `"bold italic green"`

### Message Filtering

Control which messages are displayed:

```python
ConversationVisualizer(
    skip_user_messages=False,  # Show user messages (default: True)
    skip_system_messages=False, # Show system messages (default: False)
)
```

## Advanced Usage

### Combining with Callbacks

You can still use custom callbacks alongside a custom visualizer:

```python
def my_callback(event):
    # Custom logging or processing
    print(f"Event received: {event.event_type}")

conversation = Conversation(
    agent=agent,
    workspace=cwd,
    visualize=custom_visualizer,
    callbacks=[my_callback],  # Additional callbacks
)
```

### Disabling Visualization

To disable visualization entirely:

```python
conversation = Conversation(
    agent=agent,
    workspace=cwd,
    visualize=None,  # or False
)
```

## Next Steps

- **[Callbacks](/sdk/guides/convo-async)** - Learn about custom event callbacks
- **[Persistence](/sdk/guides/convo-persistence)** - Save and restore conversation state
- **[Pause and Resume](/sdk/guides/convo-pause-and-resume)** - Control agent execution flow
