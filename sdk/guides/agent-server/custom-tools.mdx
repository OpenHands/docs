---
title: Custom Tools with Remote Agent Server
description: Learn how to use custom tools with a remote agent server by building a custom base image that includes your tool implementations.
---

## Overview

When using a [remote agent server](/sdk/guides/agent-server/overview), custom tools must be available in the server's Python environment. This guide shows how to build a custom base image with your tools and use `DockerDevWorkspace` to automatically build the agent server on top of it.

<Note>
For standalone custom tools (without remote agent server), see the [Custom Tools guide](/sdk/guides/custom-tools).
</Note>

<Warning>
**Binary Mode Limitation**: Custom tools only work with **source mode** deployments. When using `DockerDevWorkspace`, the agent server is built in source mode by default, so custom tools work correctly. See [GitHub issue #1531](https://github.com/OpenHands/software-agent-sdk/issues/1531) for details.
</Warning>

## Complete Example

<Note>
A complete working example is available on GitHub: [examples/02_remote_agent_server/05_custom_tool/](https://github.com/OpenHands/software-agent-sdk/tree/main/examples/02_remote_agent_server/05_custom_tool)
</Note>

The example includes:
- **Custom tool implementation** (`custom_tools/log_data.py`) - A tool for logging structured data to JSON
- **Dockerfile** - Copies custom tools into a base image
- **Build script** (`build_custom_image.sh`) - Builds the custom base image
- **SDK example** (`custom_tool_example.py`) - Demonstrates the full workflow

## Quick Start

### 1. Define Your Custom Tool

Create a tool module with auto-registration at module level:

```python
from openhands.sdk import Action, Observation, ToolDefinition
from openhands.sdk.tool import ToolExecutor, register_tool

class MyAction(Action):
    param1: str

class MyObservation(Observation):
    result: str

class MyExecutor(ToolExecutor[MyAction, MyObservation]):
    def __call__(self, action: MyAction, conversation=None):
        return MyObservation(result="...")

class MyTool(ToolDefinition[MyAction, MyObservation]):
    @classmethod
    def create(cls, conv_state, **params):
        return [cls(
            description="Tool description",
            action_type=MyAction,
            observation_type=MyObservation,
            executor=MyExecutor(),
        )]

# Auto-register when module is imported
register_tool("MyTool", MyTool)
```

### 2. Create a Dockerfile

```dockerfile
FROM nikolaik/python-nodejs:python3.12-nodejs22

COPY custom_tools /app/custom_tools
ENV PYTHONPATH="/app:${PYTHONPATH}"
```

### 3. Build and Use

```bash
docker build -t custom-base-image:latest .
```

```python
from openhands.sdk import Agent, Conversation, Tool
from openhands.workspace import DockerDevWorkspace

with DockerDevWorkspace(base_image="custom-base-image:latest", host_port=8010) as workspace:
    import custom_tools.my_tool  # Register the tool
    
    tools = get_default_tools(enable_browser=False)
    tools.append(Tool(name="MyTool"))
    
    agent = Agent(llm=llm, tools=tools)
    conversation = Conversation(agent=agent, workspace=workspace)
    conversation.send_message("Use MyTool to...")
    conversation.run()
```

## How It Works

1. **Client imports tool module** → `register_tool()` registers in client's registry
2. **SDK collects tool qualnames** → Sent to server in conversation creation request
3. **Server imports modules** → Triggers `register_tool()` on server side
4. **Tools become available** → Agent can use custom tools during execution

## Troubleshooting

| Issue | Solution |
|-------|----------|
| Tool not found | Ensure `register_tool()` is called at module level, import tool before creating conversation |
| Import errors on server | Check `PYTHONPATH` in Dockerfile, verify all dependencies installed |
| Build failures | Verify file paths in `COPY` commands, ensure Python 3.12+ |

## See Also

- [Custom Tools (Standalone)](/sdk/guides/custom-tools) - For local execution without remote server
- [Agent Server Overview](/sdk/guides/agent-server/overview) - Understanding remote agent servers
