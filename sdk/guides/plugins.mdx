---
title: Plugins
description: Plugins bundle skills, hooks, MCP servers, agents, and commands into reusable packages that extend agent capabilities.
---

Plugins provide a way to package and distribute multiple agent components together. A single plugin can include:

- **Skills**: Specialized knowledge and workflows
- **Hooks**: Event handlers for tool lifecycle
- **MCP Config**: External tool server configurations
- **Agents**: Specialized agent definitions
- **Commands**: Slash commands

The plugin format is compatible with the [Claude Code plugin structure](https://github.com/anthropics/claude-code/tree/main/plugins).

## Recommended: Plugin Loading via Conversation

<Note>
This example is available on GitHub: [examples/05_skills_and_plugins/03_plugin_via_conversation/main.py](https://github.com/OpenHands/software-agent-sdk/blob/main/examples/05_skills_and_plugins/03_plugin_via_conversation/main.py)
</Note>

The recommended way to load plugins is via the `plugins` parameter on `Conversation`. This pattern:
- Supports loading multiple plugins at once
- Automatically handles all plugin components (skills, MCP config, hooks)
- Works with both local and remote (agent-server) conversations
- Reduces boilerplate code

```python icon="python" expandable examples/05_skills_and_plugins/03_plugin_via_conversation/main.py
"""Example: Loading Plugins via Conversation

This example demonstrates the recommended way to load plugins using the
`plugins` parameter on the Conversation class. This approach:

1. Automatically loads and merges multiple plugins
2. Handles skills, MCP config, and hooks automatically
3. Works with both LocalConversation and RemoteConversation
4. Supports GitHub repositories, git URLs, and local paths

This is the preferred approach over manually calling Plugin.load() and
merging components by hand.
"""

import os
import sys
import tempfile
from pathlib import Path

from pydantic import SecretStr

from openhands.sdk import LLM, Agent, Conversation
from openhands.sdk.plugin import PluginSource
from openhands.sdk.tool import Tool
from openhands.tools.file_editor import FileEditorTool
from openhands.tools.terminal import TerminalTool


# Get the directory containing this script
script_dir = Path(__file__).parent
example_plugins_dir = script_dir.parent / "02_loading_plugins" / "example_plugins"

# =============================================================================
# Part 1: Creating a Conversation with Plugins (Local Path)
# =============================================================================
print("=" * 80)
print("Part 1: Loading Plugin via Conversation (Local Path)")
print("=" * 80)

# The plugin source can be:
# - Local path: "/path/to/plugin" or "./relative/path"
# - GitHub shorthand: "github:owner/repo"
# - Git URL: "https://github.com/org/repo.git"
# - With ref: PluginSource(source="github:org/repo", ref="v1.0.0")
# - From monorepo: PluginSource(source="github:org/repo", repo_path="plugins/my-plugin")

plugin_path = example_plugins_dir / "code-quality"
print(f"Plugin source: {plugin_path}")

# Create plugin source specification
plugin_spec = PluginSource(source=str(plugin_path))
print(f"Created PluginSource: {plugin_spec.model_dump()}")

# =============================================================================
# Part 2: Multiple Plugins Example
# =============================================================================
print("\n" + "=" * 80)
print("Part 2: Loading Multiple Plugins")
print("=" * 80)

# You can specify multiple plugins - they are loaded in order
# Skills and MCP configs: last plugin wins (override by name/key)
# Hooks: all hooks concatenate (all run)
plugins = [
    PluginSource(source=str(plugin_path)),
    # Add more plugins as needed:
    # PluginSource(source="github:org/security-plugin", ref="v2.0.0"),
    # PluginSource(source="github:org/monorepo", repo_path="plugins/logging"),
]

print(f"Configured {len(plugins)} plugin(s):")
for p in plugins:
    print(f"  - {p.source}")
    if p.ref:
        print(f"    ref: {p.ref}")
    if p.repo_path:
        print(f"    repo_path: {p.repo_path}")

# =============================================================================
# Part 3: Using Plugins with an Agent
# =============================================================================
print("\n" + "=" * 80)
print("Part 3: Using Plugins with an Agent")
print("=" * 80)

# Check for API key
api_key = os.getenv("LLM_API_KEY")
if not api_key:
    print("Skipping agent demo (LLM_API_KEY not set)")
    print("\nTo run the full demo, set the LLM_API_KEY environment variable:")
    print("  export LLM_API_KEY=your-api-key")
    sys.exit(0)

# Configure LLM
model = os.getenv("LLM_MODEL", "anthropic/claude-sonnet-4-5-20250929")
llm = LLM(
    usage_id="plugin-demo",
    model=model,
    api_key=SecretStr(api_key),
)

# Create agent with tools (no need to manually configure MCP or skills)
tools = [
    Tool(name=TerminalTool.name),
    Tool(name=FileEditorTool.name),
]
agent = Agent(
    llm=llm,
    tools=tools,
    # Note: No agent_context.skills or mcp_config needed here!
    # The plugins parameter on Conversation handles this automatically.
)

# Create a temporary directory for the demo
with tempfile.TemporaryDirectory() as tmpdir:
    # Create conversation WITH plugins parameter
    # This is the key difference from the manual approach!
    conversation = Conversation(
        agent=agent,
        workspace=tmpdir,
        plugins=plugins,  # <-- Plugins are loaded and merged automatically
    )

    print("\nConversation created with plugins loaded!")
    agent_context = conversation.agent.agent_context
    skills = agent_context.skills if agent_context else []
    print(f"Agent skills: {len(skills)}")

    # Show loaded skills
    print("\nLoaded skills from plugins:")
    for skill in skills:
        print(f"  - {skill.name}")

    # Demo: Test the skill (triggered by "lint" keyword)
    print("\n--- Demo: Skill Triggering ---")
    print("Sending message with 'lint' keyword to trigger skill...")
    conversation.send_message(
        "How do I lint Python code? Just give a brief explanation."
    )
    conversation.run()

    print(f"\nTotal cost: ${llm.metrics.accumulated_cost:.4f}")

# =============================================================================
# Summary
# =============================================================================
print("\n" + "=" * 80)
print("Summary: Plugin Loading via Conversation")
print("=" * 80)
print("""
The `plugins` parameter on Conversation provides:

1. Automatic loading: Plugins are fetched and loaded automatically
2. Automatic merging: Skills, MCP configs, and hooks are merged
3. Multi-plugin support: Load multiple plugins, last one wins for conflicts
4. Git support: Use GitHub shorthand, git URLs, or local paths
5. Version pinning: Use `ref` to pin to a specific branch/tag/commit
6. Monorepo support: Use `repo_path` for plugins in subdirectories

Example:
    conversation = Conversation(
        agent=agent,
        workspace="./workspace",
        plugins=[
            PluginSource(source="github:org/security-plugin", ref="v2.0.0"),
            PluginSource(source="github:org/monorepo", repo_path="plugins/audit"),
            PluginSource(source="/local/custom-plugin"),
        ],
    )
""")
```

```bash Running the Example
export LLM_API_KEY="your-api-key"
cd agent-sdk
uv run python examples/05_skills_and_plugins/03_plugin_via_conversation/main.py
```

### Quick Reference

```python highlight={2-5,12-17}
from openhands.sdk.plugin import PluginSource

# Define plugin sources
plugins = [
    PluginSource(source="github:owner/repo", ref="v1.0.0"),
    PluginSource(source="github:org/monorepo", repo_path="plugins/my-plugin"),
    PluginSource(source="/local/path/to/plugin"),
]

# Create Conversation with plugins
# Skills, MCP config, and hooks are loaded and merged automatically
conversation = Conversation(
    agent=agent,
    workspace="./workspace",
    plugins=plugins,
)
```

## Manual Plugin Loading

<Note>
This example is available on GitHub: [examples/05_skills_and_plugins/02_loading_plugins/main.py](https://github.com/OpenHands/software-agent-sdk/blob/main/examples/05_skills_and_plugins/02_loading_plugins/main.py)

For most use cases, the [recommended approach](#recommended-plugin-loading-via-conversation) above is simpler and handles merging automatically.
</Note>

For advanced use cases where you need fine-grained control over plugin loading, you can use `Plugin.load()` directly:

```python icon="python" expandable examples/05_skills_and_plugins/02_loading_plugins/main.py
"""Example: Loading Plugins

This example demonstrates how to load plugins that bundle multiple components:
- Skills (specialized knowledge and workflows)
- Hooks (event handlers for tool lifecycle)
- MCP configuration (external tool servers)
- Agents (specialized agent definitions)
- Commands (slash commands)

Plugins follow the Claude Code plugin structure for compatibility.
See the example_plugins/ directory for a complete plugin structure.
"""

import os
import sys
import tempfile
from pathlib import Path

from pydantic import SecretStr

from openhands.sdk import LLM, Agent, AgentContext, Conversation
from openhands.sdk.plugin import Plugin
from openhands.sdk.tool import Tool
from openhands.tools.file_editor import FileEditorTool
from openhands.tools.terminal import TerminalTool


# Get the directory containing this script
script_dir = Path(__file__).parent
example_plugins_dir = script_dir / "example_plugins"

# =============================================================================
# Part 1: Loading a Single Plugin
# =============================================================================
print("=" * 80)
print("Part 1: Loading a Single Plugin")
print("=" * 80)

plugin_path = example_plugins_dir / "code-quality"
print(f"Loading plugin from: {plugin_path}")

plugin = Plugin.load(plugin_path)

print("\nPlugin loaded successfully!")
print(f"  Name: {plugin.name}")
print(f"  Version: {plugin.version}")
print(f"  Description: {plugin.description}")

# Show manifest details (extra fields are accessible via model_extra)
print("\nManifest details:")
print(f"  Author: {plugin.manifest.author}")
extra = plugin.manifest.model_extra or {}
print(f"  License: {extra.get('license', 'N/A')}")
print(f"  Repository: {extra.get('repository', 'N/A')}")

# =============================================================================
# Part 2: Exploring Plugin Components
# =============================================================================
print("\n" + "=" * 80)
print("Part 2: Exploring Plugin Components")
print("=" * 80)

# Skills
print(f"\nSkills ({len(plugin.skills)}):")
for skill in plugin.skills:
    desc = skill.description or ""
    print(f"  - {skill.name}: {desc[:60]}...")
    if skill.trigger:
        print(f"    Triggers: {skill.trigger}")

# Hooks
print(f"\nHooks: {'Configured' if plugin.hooks else 'None'}")
if plugin.hooks:
    for event_type, matchers in plugin.hooks.hooks.items():
        print(f"  - {event_type}: {len(matchers)} matcher(s)")

# MCP Config
print(f"\nMCP Config: {'Configured' if plugin.mcp_config else 'None'}")
if plugin.mcp_config is not None:
    servers = plugin.mcp_config.get("mcpServers", {})
    for server_name in servers:
        print(f"  - {server_name}")

# Agents
print(f"\nAgents ({len(plugin.agents)}):")
for agent_def in plugin.agents:
    print(f"  - {agent_def.name}: {agent_def.description[:60]}...")

# Commands
print(f"\nCommands ({len(plugin.commands)}):")
for cmd in plugin.commands:
    print(f"  - /{cmd.name}: {cmd.description[:60]}...")

# =============================================================================
# Part 3: Loading All Plugins from a Directory
# =============================================================================
print("\n" + "=" * 80)
print("Part 3: Loading All Plugins from a Directory")
print("=" * 80)

plugins = Plugin.load_all(example_plugins_dir)
print(f"\nLoaded {len(plugins)} plugin(s) from {example_plugins_dir}")
for p in plugins:
    print(f"  - {p.name} v{p.version}")

# =============================================================================
# Part 4: Using Plugin Components with an Agent
# =============================================================================
print("\n" + "=" * 80)
print("Part 4: Using Plugin Components with an Agent")
print("=" * 80)

# Check for API key
api_key = os.getenv("LLM_API_KEY")
if not api_key:
    print("Skipping agent demo (LLM_API_KEY not set)")
    print("\nTo run the full demo, set the LLM_API_KEY environment variable:")
    print("  export LLM_API_KEY=your-api-key")
    sys.exit(0)

# Configure LLM
model = os.getenv("LLM_MODEL", "anthropic/claude-sonnet-4-5-20250929")
llm = LLM(
    usage_id="plugin-demo",
    model=model,
    api_key=SecretStr(api_key),
)

# Create agent context with plugin skills
agent_context = AgentContext(
    skills=plugin.skills,
    load_public_skills=False,  # Only use plugin skills for this demo
)

# Create agent with tools and plugin MCP config
tools = [
    Tool(name=TerminalTool.name),
    Tool(name=FileEditorTool.name),
]
agent = Agent(
    llm=llm,
    tools=tools,
    agent_context=agent_context,
    mcp_config=plugin.mcp_config or {},  # Use MCP servers from plugin
)

# Create a temporary directory for the demo
with tempfile.TemporaryDirectory() as tmpdir:
    # Create conversation with plugin hooks
    conversation = Conversation(
        agent=agent,
        workspace=tmpdir,
        hook_config=plugin.hooks,  # Use hooks from plugin
    )

    # Demo 1: Test the skill (triggered by "lint" keyword)
    print("\n--- Demo 1: Skill Triggering ---")
    print("Sending message with 'lint' keyword to trigger skill...")
    conversation.send_message(
        "How do I lint Python code? Just give a brief explanation."
    )
    conversation.run()

    # Demo 2: Test hooks by using file_editor (triggers PostToolUse hook)
    print("\n--- Demo 2: Hook Execution ---")
    print("Creating a file to trigger PostToolUse hook on file_editor...")
    conversation.send_message(
        "Create a file called hello.py with a simple print statement."
    )
    conversation.run()

    # Demo 3: Test MCP by using fetch tool
    print("\n--- Demo 3: MCP Tool Usage ---")
    print("Using fetch MCP tool to retrieve a URL...")
    conversation.send_message(
        "Use the fetch tool to get the content from https://httpbin.org/get "
        "and tell me what the 'origin' field contains."
    )
    conversation.run()

    # Verify hooks executed by checking the hook log file
    print("\n--- Verifying Hook Execution ---")
    hook_log_path = os.path.join(tmpdir, ".hook_log")
    if os.path.exists(hook_log_path):
        print("Hook log file found! Contents:")
        with open(hook_log_path) as f:
            for line in f:
                print(f"  {line.strip()}")
    else:
        print("No hook log file found (hooks may not have executed)")

    print(f"\nTotal cost: ${llm.metrics.accumulated_cost:.4f}")
```

```bash Running the Example
export LLM_API_KEY="your-api-key"
cd agent-sdk
uv run python examples/05_skills_and_plugins/02_loading_plugins/main.py
```

## Plugin Structure

<Note>
See the [example_plugins directory](https://github.com/OpenHands/software-agent-sdk/tree/main/examples/05_skills_and_plugins/02_loading_plugins/example_plugins) for a complete working plugin structure.
</Note>

A plugin follows this directory structure:

```
plugin-name/
├── .plugin/
│   └── plugin.json          # Plugin metadata (required)
├── skills/                   # Skills directory (optional)
│   └── skill-name/
│       └── SKILL.md         # Skill definition
├── hooks/                    # Hooks directory (optional)
│   └── hooks.json           # Hook definitions
├── agents/                   # Agents directory (optional)
│   └── agent-name.md        # Agent definition
├── commands/                 # Commands directory (optional)
│   └── command-name.md      # Command definition
├── .mcp.json                 # MCP server config (optional)
└── README.md                 # Plugin documentation
```

### Plugin Manifest (plugin.json)

The manifest file defines plugin metadata:

```json
{
  "name": "code-quality",
  "version": "1.0.0",
  "description": "Code quality tools and workflows",
  "author": "openhands",
  "license": "MIT",
  "repository": "https://github.com/example/code-quality-plugin"
}
```

### Skills

Skills are defined in markdown files with YAML frontmatter:

```markdown
---
name: python-linting
description: Instructions for linting Python code
trigger:
  type: keyword
  keywords:
    - lint
    - linting
    - code quality
---

# Python Linting Skill

Run ruff to check for issues:

\`\`\`bash
ruff check .
\`\`\`
```

### Hooks

Hooks are defined in `hooks/hooks.json`:

```json
{
  "hooks": {
    "PostToolUse": [
      {
        "matcher": "file_editor",
        "hooks": [
          {
            "type": "command",
            "command": "echo 'File edited: $OPENHANDS_TOOL_NAME'",
            "timeout": 5
          }
        ]
      }
    ]
  }
}
```

### MCP Configuration

MCP servers are configured in `.mcp.json`:

```json
{
  "mcpServers": {
    "fetch": {
      "command": "uvx",
      "args": ["mcp-server-fetch"]
    }
  }
}
```

## Using Plugin Components

### Loading a Plugin

```python
from openhands.sdk.plugin import Plugin

# Load a single plugin
plugin = Plugin.load("/path/to/plugin")

# Load all plugins from a directory
plugins = Plugin.load_all("/path/to/plugins")
```

### Accessing Components

```python
# Skills
for skill in plugin.skills:
    print(f"Skill: {skill.name}")

# Hooks configuration
if plugin.hooks:
    print(f"Hooks configured: {plugin.hooks}")

# MCP servers
if plugin.mcp_config:
    servers = plugin.mcp_config.get("mcpServers", {})
    print(f"MCP servers: {list(servers.keys())}")
```

### Using with an Agent

```python highlight={3,10,17}
# Create agent context with plugin skills
agent_context = AgentContext(
    skills=plugin.skills,
)

# Create agent with plugin MCP config
agent = Agent(
    llm=llm,
    tools=tools,
    mcp_config=plugin.mcp_config or {},
    agent_context=agent_context,
)

# Create conversation with plugin hooks
conversation = Conversation(
    agent=agent,
    hook_config=plugin.hooks,
)
```

## Next Steps

- **[Skills](/sdk/guides/skill)** - Learn more about skills and triggers
- **[Hooks](/sdk/guides/hooks)** - Understand hook event types
- **[MCP Integration](/sdk/guides/mcp)** - Configure external tool servers
